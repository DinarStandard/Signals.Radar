<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Signals.Radar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Favicon using Mosaic logo -->
  <link
    rel="icon"
    href="https://mosaiclive.com/wp-content/uploads/42-ml__0017_Vector-Smart-Object.png"
    type="image/png"
  />
  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
    rel="stylesheet"
  />
  <!-- Bootstrap 5 CSS via CDN -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-ENjdO4Dr2bkBIFxQvdQaC5Z6mCqMtGZYc9C+EHknIr9zmC9F3RjlKcPR1hAXszv/"
    crossorigin="anonymous"
  />
  <style>
    /* ================================================
       1) GLOBAL RESET & ROOT VARIABLES
    ================================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    :root {
      font-size: 16px;
      --bg-start: #1a1a1a;
      --bg-end: #2c2c2c;
      --text-color: #f0f0f0;

      /* Default/fallback color if category isn't found */
      --primary-color: #63b3ed;

      /* Category main colors (for signals) */
      --color-digital-health: #4477aa;
      --color-smart-cities:  #aa7744;
      --color-public-health:  #44aa77;
      --color-economic-dev:  #aa4477;
      --color-other:         #7744aa;
      /* A color for placeholder/dummy signals */
      --color-placeholder:   #666;

      /* Category gradient for filter bubbles */
      --grad-digital-health: linear-gradient(45deg, #6699cc, #4477aa);
      --grad-smart-cities:   linear-gradient(45deg, #cc9966, #aa7744);
      --grad-public-health:  linear-gradient(45deg, #66cc99, #44aa77);
      --grad-economic-dev:   linear-gradient(45deg, #cc6699, #aa4477);
      --grad-other:          linear-gradient(45deg, #9966cc, #7744aa);

      --button-hover: #4fd1c5;
      --border-color: #444;
      --font-family: 'Roboto', sans-serif;
    }

    /* ================================================
       2) GLOBAL STYLES
    ================================================ */
    body {
      font-family: var(--font-family);
      background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      line-height: 1.5;
    }
    :focus {
      outline: 2px dashed #fff;
      outline-offset: 4px;
    }

    /* ================================================
       3) HEADER & NAVIGATION
    ================================================ */
    header {
      width: 100%;
      background: #111;
      padding: 1rem 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.5);
      position: relative;
      z-index: 1002;
    }
    .nav-container {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    .categories {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .category-wrapper {
      position: relative;
    }
    .category-bubble {
      color: #fff;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      font-size: 0.95rem;
      border: none;
      cursor: pointer;
      transition: opacity 0.3s, transform 0.2s;
      background: var(--primary-color);
    }
    .category-bubble:hover {
      transform: translateY(-2px);
      opacity: 0.85;
    }
    .category-bubble.active {
      transform: translateY(-2px);
      border: 2px solid #fff;
      opacity: 1;
    }
    .sub-bubble-list {
      position: absolute;
      top: 110%;
      left: 0;
      background: #222;
      border-radius: 0.5rem;
      padding: 0.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s;
      z-index: 10;
    }
    .category-wrapper:hover .sub-bubble-list {
      opacity: 1;
      visibility: visible;
    }
    .sub-bubble {
      display: block;
      background: transparent;
      border: none;
      color: #fff;
      padding: 0.5rem 1rem;
      text-align: left;
      cursor: pointer;
      transition: background 0.2s;
    }
    .sub-bubble:hover {
      background: rgba(255,255,255,0.1);
    }
    .sub-bubble-list::before {
      content: "";
      position: absolute;
      top: -10px;
      left: 15px;
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 10px solid #222;
    }

    /* ================================================
       3.5) TIMELINE BAR (CIRCULAR NODES)
    ================================================ */
    .timeline-container {
      width: 100%;
      background: #111;
      padding: 0.5rem 0;
      overflow-x: auto;
      white-space: nowrap;
      display: flex;
      justify-content: center;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      scroll-padding-left: 1rem;
    }
    .timeline-bar {
      display: inline-flex;
      align-items: center;
      gap: 1rem;
    }
    .timeline-node {
      position: relative;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: transform 0.3s;
      scroll-snap-align: center;
    }
    .timeline-node .week-circle {
      width: 2.5rem;
      height: 2.5rem;
      background: linear-gradient(45deg, #333, #555);
      border-radius: 50%;
      border: 2px solid transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 0.9rem;
      margin-bottom: 0.25rem;
      transition: background 0.3s, transform 0.3s;
    }
    .timeline-node:hover .week-circle {
      background: var(--button-hover);
    }
    .timeline-node.current-week .week-circle {
      background: var(--primary-color);
      border: 2px solid #fff;
      transform: scale(1.1);
    }
    .timeline-node.dummy .week-circle {
      background: #777;
    }
    .week-label {
      color: #ccc;
      font-size: 0.85rem;
      text-align: center;
      white-space: nowrap;
    }
    .timeline-line {
      width: 2rem;
      height: 2px;
      background: #555;
      flex-shrink: 0;
    }

    /* ================================================
       4) RADAR CONTAINER & SIGNALS
    ================================================ */
    .radar-container {
      position: relative;
      width: 90%;
      max-width: 1200px;
      margin: 1rem auto;
      min-height: 600px;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      overflow: hidden;
      z-index: 1;
      transition: opacity 0.4s ease;
    }
    @keyframes fadeOutIn {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    .week-transition {
      animation: fadeOutIn 0.6s;
    }

    /* Meteor-Shower Particles */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      opacity: 0.7;
    }
    .particle {
      position: absolute;
      width: 2px;
      height: 14px;
      background: rgba(255,255,255,0.25);
      border-radius: 0.5rem;
      transform: rotateZ(-45deg);
      animation: meteor 2.5s linear infinite;
    }
    @keyframes meteor {
      0% { opacity: 0; transform: translate(-100px, 0) rotateZ(-45deg); }
      5% { opacity: 1; }
      95% { opacity: 1; }
      100% { opacity: 0; transform: translate(300px,300px) rotateZ(-45deg); }
    }
    .curved-lines {
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 550px;
      z-index: 1;
    }
    .curved-lines path {
      fill: none;
      stroke: var(--primary-color);
      stroke-dasharray: 4, 4;
      stroke-width: 2;
      opacity: 0.5;
    }
    .curved-lines text {
      fill: var(--text-color);
      font-size: 16px;
      font-family: var(--font-family);
    }
    .signal {
      position: absolute;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      z-index: 2;
      transition: transform 0.2s, opacity 0.5s;
      animation: pulse 2s infinite alternate;
    }
    .signal:hover {
      transform: scale(1.12);
      box-shadow: 0 0 16px rgba(255,255,255,0.4);
    }
    @keyframes pulse {
      0%   { box-shadow: 0 0 4px rgba(255,255,255,0.15); }
      50%  { box-shadow: 0 0 16px rgba(255,255,255,0.3); }
      100% { box-shadow: 0 0 4px rgba(255,255,255,0.15); }
    }

    /* ================================================
       5) QUICK VIEW / DETAILED CARD (Modal)
    ================================================ */
    .quick-view-card {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 1.5rem;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 1003;
      display: none;
      color: #fff;
    }
    .quickview-close {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      color: #fff;
      cursor: pointer;
    }
    .preview-content {
      display: flex;
      gap: 1rem;
    }
    .preview-img {
      flex: 0 0 20%;
      max-width: 20%;
      border-radius: 0.25rem;
      object-fit: cover;
      background: #333;
    }
    .preview-text {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .preview-text .title {
      font-size: 1.1rem;
      font-weight: 700;
      text-transform: uppercase;
      margin-bottom: 0.5rem;
      color: #fff;
    }
    .preview-label {
      color: #68d391;
      font-weight: 600;
      margin-right: 0.25rem;
    }
    .desc {
      font-size: 0.9rem;
      margin-top: 0.5rem;
      line-height: 1.4;
    }
    .btn-extended {
      font-size: 1rem;
      padding: 0.75rem 1.25rem;
      background: #68d391;
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn-extended:hover {
      background: var(--button-hover);
    }
    .quick-view-card.expanded .preview-content {
      display: none;
    }
    .detailed-content {
      display: none;
    }
    .quick-view-card.expanded .detailed-content {
      display: block;
    }
    .card-top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: flex-start;
    }
    .metrics-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      flex: 1 1 auto;
      min-width: 250px;
    }
    .metric-box {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      background: linear-gradient(45deg, rgba(255,255,255,0.05), rgba(255,255,255,0.1));
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 0.5rem;
      padding: 1rem;
      margin: 0.5rem 0;
    }
    .metric-title {
      font-size: 1rem;
      margin-bottom: 0.25rem;
      font-weight: 700;
      color: #68d391;
    }
    .metric-value {
      font-weight: 600;
      font-size: 1.2rem;
      line-height: 1.4;
    }
    .card-image-wrapper {
      flex: 1 1 auto;
      min-width: 200px;
      text-align: center;
    }
    .card-image-wrapper img {
      max-width: 100%;
      height: auto;
      border-radius: 0.5rem;
    }
    .card-image-wrapper .image-credit {
      font-size: 0.8rem;
      color: #aaa;
    }
    .section {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 4px;
      padding: 1rem;
      margin-bottom: 1rem;
      position: relative;
    }
    .section-header {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      padding-bottom: 0.25rem;
    }
    /* SIGNAL DEVELOPMENT SECTION (12 months) */
    #devSection .dev-holo-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 1.8rem;
      height: 1.8rem;
      border-radius: 50%;
      background: var(--primary-color);
      color: #fff;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      margin-left: 0.5rem;
      border: 2px solid #fff;
      box-shadow: 0 0 6px rgba(99, 179, 237, 0.7);
      transition: box-shadow 0.3s;
    }
    #devSection .dev-holo-icon:hover {
      box-shadow: 0 0 10px rgba(99, 179, 237, 0.9);
    }
    #devSection .dev-image {
      max-width: 100%;
      margin-top: 0.5rem;
    }
    /* Floating legend: positioned relative to the dev section */
    #devSection .dev-holo-legend {
      display: none;
      position: absolute;
      top: 2rem;
      right: 1rem;
      background: rgba(0, 0, 0, 0.9);
      padding: 1rem;
      border-radius: 8px;
      width: 260px;
      color: #f0f0f0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.8);
      z-index: 10;
    }
    #devSection .dev-holo-legend h4 {
      margin: 0.5rem 0 0.25rem;
      color: var(--primary-color);
    }
    #devSection .dev-holo-legend ul {
      list-style: disc;
      margin-left: 1.5rem;
    }
    /* Detailed "Show More" styling */
    .show-more-detailed {
      color: var(--button-hover);
      cursor: pointer;
      text-decoration: underline;
      display: inline-block;
      margin-top: 0.5rem;
    }
    .expanded-section {
      white-space: pre-wrap;
    }
    .btn-back {
      background: #333;
      color: #fff;
      border: 1px solid #555;
      margin-bottom: 1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
    }
    .arrow-icon {
      font-size: 1.2rem;
    }

    @media (max-width: 768px) {
      .card-top-row {
        flex-direction: column;
      }
      .preview-content {
        flex-direction: column;
        align-items: flex-start;
      }
      .preview-img {
        max-width: 100%;
        margin-bottom: 0.5rem;
      }
    }

    /* ================================================
       6) FOOTER & LOGO
    ================================================ */
    footer {
      margin-top: auto;
      background: #111;
      padding: 2rem 1rem;
      z-index: 1002;
    }
    .footer-content {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .footer-logo img {
      max-height: 100px;
      width: auto;
      height: auto;
    }
    .footer-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    /* ================================================
       7) LEGEND
    ================================================ */
    .legend-icon {
      position: absolute;
      bottom: 1rem;
      right: 1rem;
      width: 2.2rem;
      height: 2.2rem;
      border-radius: 50%;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      background: transparent;
      cursor: pointer;
      text-align: center;
      line-height: 2rem;
      font-size: 1.2rem;
      transition: background 0.3s, color 0.3s;
      z-index: 9999;
    }
    .legend-icon:hover {
      background: var(--primary-color);
      color: #111;
    }
    .legend-panel {
      position: absolute;
      bottom: 5rem;
      right: 1rem;
      background: #222;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 0.5rem;
      padding: 1rem;
      width: 240px;
      display: none;
      z-index: 9999;
    }
    .legend-panel.show {
      display: block;
    }
    .legend-panel h3 {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
    }
    .legend-panel h4 {
      font-size: 0.95rem;
      margin: 0.75rem 0 0.25rem;
      color: #68d391;
    }
    .impact-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.4rem;
    }
    .impact-ball {
      border-radius: 50%;
      background: var(--primary-color);
      display: inline-block;
    }
    .impact-ball.low {
      width: 1.5rem;
      height: 1.5rem;
    }
    .impact-ball.med {
      width: 2.2rem;
      height: 2.2rem;
    }
    .impact-ball.high {
      width: 2.9rem;
      height: 2.9rem;
    }
    .legend-panel p {
      font-size: 0.9rem;
      line-height: 1.4;
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header>
    <div class="nav-container">
      <div class="logo">Signal.Radar</div>
      <div class="categories" id="categoryContainer">
        <!-- Category Bubbles -->
        <div class="category-wrapper">
          <button class="category-bubble" data-category="All">All</button>
        </div>
        <div class="category-wrapper">
          <button class="category-bubble" data-category="Behaviour">Behaviour</button>
        </div>
        <div class="category-wrapper">
          <button class="category-bubble" data-category="Healthcare">Healthcare</button>
        </div>
        <div class="category-wrapper">
          <button class="category-bubble" data-category="Infrastructure">Infrastructure</button>

        </div>
        <div class="category-wrapper">
          <button class="category-bubble" data-category="Regulation">Regulation</button>
        </div>
        <div class="category-wrapper">
          <button class="category-bubble" data-category="Technology">Technology</button>
        </div>
      </div>
    </div>
  </header>

  <!-- TIMELINE (CIRCULAR NODES) -->
  <div class="timeline-container">
    <div class="timeline-bar">
      <!-- Node for 1-7 March (current) -->
      <div class="timeline-node current-week" data-week="1-7 March">
        <div class="week-circle">1</div>
        <div class="week-label">1–7 Mar</div>
      </div>
      <div class="timeline-line"></div>
      <!-- Node for 8-14 March (dummy) -->
      <div class="timeline-node dummy" data-week="8-14 March">
        <div class="week-circle">2</div>
        <div class="week-label">8–14 Mar</div>
      </div>
      <div class="timeline-line"></div>
      <!-- Node for 15-21 March (dummy) -->
      <div class="timeline-node dummy" data-week="15-21 March">
        <div class="week-circle">3</div>
        <div class="week-label">15–21 Mar</div>
      </div>
      <div class="timeline-line"></div>
      <!-- Node for 22-28 March (dummy) -->
      <div class="timeline-node dummy" data-week="22-28 March">
        <div class="week-circle">4</div>
        <div class="week-label">22–28 Mar</div>
      </div>
      <div class="timeline-line"></div>
      <!-- Node for 29 Mar–4 Apr (dummy) -->
      <div class="timeline-node dummy" data-week="29 Mar–4 Apr">
        <div class="week-circle">5</div>
        <div class="week-label">29 Mar–4 Apr</div>
      </div>
    </div>
  </div>

  <!-- RADAR CONTAINER -->
  <div class="radar-container" id="radarContainer">
    <!-- Meteor Shower -->
    <div class="particles">
      <div class="particle" style="top: 5%; left: 10%; animation-delay: 0.2s;"></div>
      <div class="particle" style="top: 15%; left: 40%; animation-delay: 1s;"></div>
      <div class="particle" style="top: 25%; left: 70%; animation-delay: 0.5s;"></div>
      <div class="particle" style="top: 35%; left: 20%; animation-delay: 1.3s;"></div>
      <div class="particle" style="top: 45%; left: 50%; animation-delay: 2s;"></div>
      <div class="particle" style="top: 55%; left: 80%; animation-delay: 0.8s;"></div>
      <div class="particle" style="top: 65%; left: 30%; animation-delay: 1.6s;"></div>
      <div class="particle" style="top: 75%; left: 60%; animation-delay: 0.9s;"></div>
      <div class="particle" style="top: 85%; left: 10%; animation-delay: 1.9s;"></div>
    </div>

    <!-- Horizontal Arcs -->
    <svg class="curved-lines" viewBox="0 0 1000 550" preserveAspectRatio="none">
      <path d="M 0,50 Q 500,-50 1000,50" />
      <text x="20" y="40">Weak</text>
      <path d="M 0,275 Q 500,175 1000,275" />
      <text x="20" y="260">Medium</text>
      <path d="M 0,500 Q 500,400 1000,500" />
      <text x="20" y="510">Strong</text>
    </svg>

    <!-- 13 Signals => 1-7 March -->
  <!-- 1) Digital Health Tools for Lifestyle & Prevention -->
  <div
    class="signal"
    style="top: 10%; left: 15%;"
    data-week="1-7 March"
    data-category="Technology"
    data-subcategory="Digital Tools"
    data-title="Digital Health Tools for Lifestyle & Prevention"
    data-strength="Weak"
    data-impact="Medium"
    data-description="Technology-driven health interventions, such as smartphone apps for fitness, nutrition, mental wellness; wearable devices tracking activity; telehealth and remote coaching programs for chronic disease prevention. These address risks by providing continuous support and feedback in health interventions. The increase in availability and adoption is a technological trigger for these tools to be integrated as part of public health programs and initiatives."
    data-reference="Germany’s digital prescriptions have seen apps for things like insomnia or obesity being used – one patient reported it was like 'having a physiotherapist and dietitian in my pocket' (testimonial in a German health magazine)."
    data-dev="Digital Health Tools for Lifestyle & Prevention.png"
    data-dubai="Dubai is a tech-savvy city and has eagerly adopted digital health solutions. The Dubai Health Authority’s 'Doctor for Every Citizen' telehealth service launched in 2019 provides 24/7 free teleconsultations for UAE nationals, integrating electronic medical records for seamless care​."
    data-image="https://www.healthcareitnews.com/sites/hitn/files/health%20apps.jpg"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="wam.ae, pmc.ncbi.nlm.nih.gov"
    data-policy="Integrate approved digital tools into public health programs. Consider creating a formulary of vetted health apps that physicians can 'prescribe' and insurers could cover subscription costs. Incorporate a city-branded app that residents can use for a healthy lifestyle, with periodic challenges and rewards."
    data-intervention-type="Technology"
  ></div>

  <!-- 2) Alcohol Harm Reduction Initiatives -->
  <div
    class="signal"
    style="top: 12%; left: 35%;"
    data-week="1-7 March"
    data-category="Regulation"
    data-subcategory="Alcohol"
    data-title="Alcohol Harm Reduction Initiatives"
    data-strength="Weak"
    data-impact="Medium"
    data-description="City interventions on alcohol often focus on regulating availability and changing social norms. This can include zoning laws, setting earlier closing times for bars to reduce binge drinking and related harms, and running public awareness or alternative recreation programs to shift culture. Story: In cities like Amsterdam, nightlife initiatives ('Celebrate Safe') provide free water and late-night transport to curb drunk driving and dehydration – young adults share testimonials of how these measures have helped them party more responsibly."
    data-reference="N/A"
    data-dev="Alcohol Harm Reduction Initiatives.png"
    data-dubai="Dubai strictly regulates alcohol sales..."
    data-image="https://www.freemalaysiatoday.com/_next/image/?url=https%3A%2F%2Fmedia.freemalaysiatoday.com%2Fwp-content%2Fuploads%2F2016%2F03%2Fdrinking.jpg&w=1920&q=75"
    data-image-size="400x250"
    data-imagecredit="Free Malaysia Today"
    data-sources="https://volteface.me/app/uploads/2018/07/Night-Lives-PDF.pdf"
    data-policy=""
    data-intervention-type="Regulation"
  ></div>
  <!-- 3) Reducing Food Waste for Healthy Meals -->
  <div
    class="signal"
    style="top: 14%; left: 55%;"
    data-week="1-7 March"
    data-category="Behaviour"
    data-subcategory="Food Waste"
    data-title="Reducing Food Waste for Healthy Meals"
    data-strength="High"
    data-impact="Medium"
    data-description="This signal focuses on capturing edible food that would be discarded and redirecting it into healthy food offerings. It addresses the risk of poor diet especially among vulnerable groups by providing nutritious meals at low cost and tackles the massive waste of resources in the food system. Programs like 'Too Good To Go' connect bakeries with surplus food at day’s end. Story: In Copenhagen, a local non-profit launched a programme where volunteers collect excess vegetables from markets, and chefs turn them into soups or stews for community centers."
    data-reference="N/A"
    data-dev="Reducing Food Waste for Healthy Meals.png"
    data-dubai="Dubai allows regulated alcohol sales, balancing cultural norms with its expat and tourism appeal. While not framed as a food waste campaign, the city’s regulatory environment influences resource use."
    data-image="https://tableo.com/wp-content/uploads/2023/07/Restaurant-Food-Waste-1024x683.webp"
    data-image-size="400x250"
    data-imagecredit="Tableo"
    data-sources="https://discoverstudyabroad.org/how-to-build-sustainable-food-habits-abroad/"
    data-policy="Maintaining and strictly enforcing the current regulatory framework. Mandate training for hospitality staff on responsible serving or expand availability of alcohol-free entertainment options. Monitor consumption patterns to ensure there isn’t a spike in harmful use."
    data-intervention-type="Behaviour"
  ></div>
  <!-- 4) Pedestrian-Friendly Urban Spaces -->
  <div
    class="signal"
    style="top: 30%; left: 10%;"
    data-week="1-7 March"
    data-category="Infrastructure"
    data-subcategory="Pedestrian"
    data-title="Pedestrian-Friendly Urban Spaces"
    data-strength="Moderate"
    data-impact="High"
    data-description="Cities are reclaiming streets for people. Initiatives range from permanent pedestrian zones to temporary street closures and parklets (mini-parks in parking spots). In Tbilisi, for example, the city organized car-free days on a major street so residents could imagine new uses of the space – addressing traffic emissions and inactivity by literally clearing the air. Story: In Lisbon, a formerly congested square transformed into a community hub has been described as 'getting our city back for people.'"
    data-reference="N/A"
    data-dev="Pedestrian-Friendly Urban Spaces (Car-Free Zones & Parklets).png"
    data-dubai="Dubai has improved pedestrian infrastructure with dedicated promenades..."
    data-image="https://blog.ptvgroup.com/wp-content/uploads/2022/03/Pedestrian-friendly-street-design.jpg"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="who.int"
    data-policy="Protect land for parks amid urban expansion; invest in the maintenance and programming of these spaces. Promote nature-based solutions like urban forestry and link healthcare with nature (e.g., 'green prescriptions')."
    data-intervention-type="Infrastructure"
  ></div>
  <!-- 5) Healthy Food Environments -->
  <div
    class="signal"
    style="top: 34%; left: 30%;"
    data-week="1-7 March"
    data-category="Regulation"
    data-subcategory="Food Environment"
    data-title="Healthy Food Environments"
    data-strength="Moderate"
    data-impact="High"
    data-description="Healthy food environment interventions seek to make the healthy choice the easy choice. This includes policies such as restricting junk-food marketing and improving school or workplace nutrition. The risk addressed is poor diet—a major driver of obesity, type-2 diabetes, and cardiovascular disease. Story: The Transport for London advertising ban led to significantly lower purchases of chocolates, sweets, and other HFSS products."
    data-reference="evidence.nihr.ac.uk"
    data-dev="Healthy Food Environments (Policy & Urban Food Culture).png"
    data-dubai="Dubai has introduced a sugar tax and enforced school canteen guidelines, among other initiatives."
    data-image="https://images.pexels.com/photos/1640775/pexels-photo-1640775.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
    data-image-size="400x250"
    data-imagecredit="Pexels"
    data-sources="New Food Magazine"
    data-policy=""
    data-intervention-type="Regulation"
  ></div>
  <!-- 6) Community Urban Farming & Gardens -->
  <div
    class="signal"
    style="top: 38%; left: 50%;"
    data-week="1-7 March"
    data-category="Infrastructure"
    data-subcategory="Urban Agriculture"
    data-title="Community Urban Farming & Gardens"
    data-strength="Moderate"
    data-impact="Medium"
    data-description="This signal involves residents cultivating food in city environments—from allotment gardens and rooftop farms to community orchards. It addresses risks of poor diet by increasing access to fresh produce and reduces social isolation as gardens bring people together. Story: In Lisbon, community gardens have transformed neighborhoods by hosting weekend farmers’ markets and teaching children how to grow vegetables."
    data-reference="childinthecity.org"
    data-dev="Community Urban Farming & Gardens.png"
    data-dubai="Dubai promotes urban farming via vertical farms..."
    data-image="https://cdn.mos.cms.futurecdn.net/FZ8WKTWr4RRWevx7eVxoAn-1600-80.jpg.webp"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="who.int, wam.ae"
    data-policy=""
    data-intervention-type="Infrastructure"
  ></div>
  <!-- 7) Tobacco-Free Environments & Control Initiatives -->
  <div
    class="signal"
    style="top: 42%; left: 70%;"
    data-week="1-7 March"
    data-category="Regulation"
    data-subcategory="Tobacco Control"
    data-title="Tobacco-Free Environments & Control Initiatives"
    data-strength="Moderate"
    data-impact="High"
    data-description="This signal encompasses policies and interventions to reduce tobacco use and exposure. It includes expanding smoke-free public spaces, strict enforcement of bans, high taxation, and even measures like banning cigarette sales to future generations. Story: The Milan outdoor smoking ban illustrates a societal shift, with a Milanese mother expressing relief at being able to take her child to the park without secondhand smoke."
    data-reference="aa.com.tr"
    data-dev="Tobacco-Free Environments & Control Initiatives.png"
    data-dubai="Reducing tobacco consumption is a key healthcare KPI in the UAE. Local laws prohibit sales to children and restrict smoking in vehicles and indoor spaces where children are present."
    data-image="https://global.unitednations.entermediadb.net/assets/mediadb/services/module/asset/downloads/preset/Collections/Embargoed/15-01-2024-Unsplash-tobacco-01.jpg/image1170x530cropped.jpg"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="aa.com.tr, u.ae"
    data-policy="Drive tobacco use down through comprehensive, intersectoral strategies. Work with education authorities to implement school-based tobacco prevention and extend smoke-free zones in popular outdoor areas."
    data-intervention-type="Regulation"
  ></div>
  <!-- 8) completed: Comprehensive Childhood Obesity Programs -->
  <div
    class="signal"
    style="top: 46%; left: 15%;"
    data-week="1-7 March"
    data-category="Healthcare"
    data-subcategory="Childhood Obesity"
    data-title="Comprehensive Childhood Obesity Programs"
    data-strength="MEDIUM"
    data-impact="High"
    data-description="Amsterdam’s childhood obesity program led to a 12% decline in overweight cases by promoting healthy eating, physical activity, and behavior change across schools, homes, and communities.
 These programs are long-term, integrated interventions spanning schools, home, community and healthcare settings to promote healthy eating, physical activity, and behavior change in children. They address multiple risk factors: poor diet, physical inactivity, and even sleep and screen time. "
    data-reference="obesityactionscotland.org"
    data-dev="Comprehensive Childhood Obesity Programs.png"
    data-dubai="Childhood obesity has become a growing concern in the UAE. Dubai’s government has initiated several programmes, with schools being a primary focus beyond just banning junk food in canteens."
    data-image="https://centerforhealthjournalism.org/sites/default/files/styles/inline_image/public/title_images/IMG_0800.jpg?itok=ywh4zWTT"
    data-image-size="400x250"
    data-imagecredit="centerforhealthjournalism"
    data-sources="obesityactionscotland.org, expatwoman.com"
    data-policy="Ensure healthy food access by subsidizing healthier school meals or mandating standards for food sold near schools. Institutionalize comprehensive programmes with unified political commitment and sustained budgeting, and encourage healthy community designs (e.g., safe sidewalks and playgrounds)."
    data-intervention-type="Healthcare"
  ></div>
  <!-- 9) Social Prescribing & Community Health Referrals -->
  <div
    class="signal"
    style="top: 50%; left: 35%;"
    data-week="1-7 March"
    data-category="Healthcare"
    data-subcategory="Social Prescribing"
    data-title="Social Prescribing & Community Health Referrals"
    data-strength="Moderate"
    data-impact="Medium"
    data-description="Social prescribing involves healthcare providers referring patients to non-clinical services—such as exercise groups, art classes, gardening clubs, debt counseling, or volunteering opportunities—to address issues that medicine alone cannot solve. Story: In England, a large-scale rollout included the success of a 'Walk and Talk' group where a widowed, isolated patient found renewed social connection."
    data-reference="socialprescribingacademy.org.uk"
    data-dev="Social Prescribing & Community Health Referrals.png"
    data-dubai="While not yet formalized, Dubai’s healthcare model shows elements of social prescribing through its wellness centers offering multidisciplinary lifestyle modification programmes."
    data-image="https://www.pulsetoday.co.uk/wp-content/uploads/2022/10/%E2%80%98Absence-of-evidence-to-support-social-prescribing-finds-major-review.jpg"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="england.nhs.uk, socialprescribingacademy.org.uk"
    data-policy="Pilot a formal social prescribing framework with insurance or government funding. Integrate social connectivity metrics into city well-being indices and support community centre expansion and intergenerational programmes."
    data-intervention-type="Healthcare"
  ></div>
  <!-- 10) Combating Social Isolation & Loneliness -->
  <div
    class="signal"
    style="top: 54%; left: 55%;"
    data-week="1-7 March"
    data-category="Behaviour"
    data-subcategory="Social Isolation"
    data-title="Combating Social Isolation & Loneliness"
    data-strength="Moderate"
    data-impact="High"
    data-description="Interventions range from creating social opportunities (community centres, befriending programmes, senior clubs, intergenerational activities) to systemic changes like age-friendly city designs and public campaigns. Story: In London, a 'Coffee and Catch-up' programme paired volunteers with isolated older adults, giving one participant something to look forward to each week."
    data-reference="https://www.livelyupyourself.co.uk/online-workshops/coffee-catch-up"
    data-dev="Combating Social Isolation & Loneliness.png"
    data-dubai="Dubai supports various community initiatives targeting isolation, recognizing that even in its strong family-oriented culture, some groups (such as expatriate seniors) can be vulnerable."
    data-image="https://images.pexels.com/photos/7929443/pexels-photo-7929443.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
    data-image-size="400x250"
    data-imagecredit="Pexels"
    data-sources="https://www.livelyupyourself.co.uk/online-workshops/coffee-catch-up"
    data-policy="Explore enshrining a 'right to disconnect' after work hours, setting a norm for both public and private sectors."
    data-intervention-type="Behaviour"
  ></div>
  <!-- 11) Active Mobility Infrastructure (Cycling & Walking) -->
  <div
    class="signal"
    style="top: 70%; left: 15%;"
    data-week="1-7 March"
    data-category="Infrastructure"
    data-subcategory="Mobility"
    data-title="Active Mobility Infrastructure (Cycling & Walking)"
    data-strength="Strong"
    data-impact="High"
    data-description="Cities are redesigning streets to favour cyclists and walkers. For example, Paris saw a 166% surge in cycling after bold investments, and Amsterdam introduced citywide 30 km/h limits for safer streets. Story: In Helsinki, sustained efforts led to zero pedestrian fatalities in 2019, showcasing the impact of design changes."
    data-reference="ecf.com"
    data-dev="Active Mobility Infrastructure.png"
    data-dubai="Dubai is expanding cycling tracks to 739 km by 2026 as part of its ambition to become a bicycle-friendly city."
    data-image="https://www.mot.gov.sg/images/default-source/mot/what-we-do/active-mobility/am-landing-main-image21ac06bb9e0342419a8528f91f60e5da.jpg?sfvrsn=97af4420_2"
    data-image-size="400x250"
    data-imagecredit="Placeholder.com"
    data-sources="ecf.com"
    data-policy="Integrate active mobility into urban planning with incentives such as public bike-share programmes and car-free days, and design pedestrian-friendly measures (e.g., shaded walkways) to ensure year-round usability."
    data-intervention-type="Infrastructure"
  ></div>
  <!-- 12) Urban Green & Blue Spaces for Wellness -->
  <div
    class="signal"
    style="top: 70%; left: 40%;"
    data-week="1-7 March"
    data-category="Infrastructure"
    data-subcategory="Green"
    data-title="Urban Green & Blue Spaces for Wellness"
    data-strength="Strong"
    data-impact="High"
    data-description="Green (parks, trees) and blue (waterfronts, rivers) spaces are being expanded or redesigned to create healthier environments. Research in Europe links accessible green areas with lower childhood obesity and reduced depression. Story: In Malmö, Sweden, a new waterfront park became a 'stress relief spot' for residents after work."
    data-reference="N/A"
    data-dev="Urban Green & Blue Spaces for Wellness.png"
    data-dubai="Dubai has begun converting select streets into pedestrian promenades and walk zones as part of its 2040 Master Plan."
    data-image="https://c.pxhere.com/photos/46/dc/lake_balaton_tihany_hungary_water_lake_clouds_tihany_peninsula_park-1325571.jpg!d"
    data-image-size="400x250"
    data-imagecredit="PXHere"
    data-sources="Elsevier Journal https://doi.org/10.1016/j.envres.2020.110169"
    data-policy="Embed food waste-to-food initiatives within Circular Economy Policy by linking large food businesses with community kitchens and establishing cold chain storage hubs for safe redistribution of fresh foods."
    data-intervention-type="Infrastructure"
  ></div>
  <!-- 13) De-work (Flexible & Shorter Workweeks) -->
  <div
    class="signal"
    style="top: 70%; left: 65%;"
    data-week="1-7 March"
    data-category="Regulation"
    data-subcategory="Workweek"
    data-title="De-work (Flexible & Shorter Workweeks)"
    data-strength="Strong"
    data-impact="Medium"
    data-description="Flexible and shorter workweeks improve work-life balance, reduce stress, and maintain productivity."
    data-reference="N/A"
    data-dev="Work-Life Balance & Mental Well-being Initiatives.png"
    data-dubai="Dubai adopted a 4.5-day workweek in 2022 as part of its modern work practices."
    data-image="https://c.pxhere.com/images/9a/b7/22b73767b98e5a150c94b9b85350-1458637.jpg!d"
    data-image-size="400x250"
    data-imagecredit="PXHere"
    data-sources="Forbes"
    data-policy=""
    data-intervention-type="Regulation"
  ></div>


    <!-- Example DUMMY signals for future weeks -->
    <!-- 8-14 March -->
    <div
      class="signal"
      style="top: 20%; left: 20%;"
      data-week="8-14 March"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>
    <div
      class="signal"
      style="top: 40%; left: 50%;"
      data-week="8-14 March"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>
    <!-- 15-21 March -->
    <div
      class="signal"
      style="top: 25%; left: 40%;"
      data-week="15-21 March"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>
    <div
      class="signal"
      style="top: 45%; left: 60%;"
      data-week="15-21 March"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>
    <!-- 22-28 March -->
    <div
      class="signal"
      style="top: 20%; left: 60%;"
      data-week="22-28 March"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>
    <!-- 29 Mar–4 Apr -->
    <div
      class="signal"
      style="top: 30%; left: 70%;"
      data-week="29 Mar–4 Apr"
      data-category="Placeholder"
      data-subcategory="Dummy"
      data-title="Placeholder Signal"
      data-strength="N/A"
      data-impact="Low"
      data-description="Gray placeholder for future data."
    ></div>

    <!-- LEGEND -->
    <div class="legend-icon" id="legendIcon" title="Show Legend">?</div>
    <div class="legend-panel" id="legendPanel">
      <h3>Legend</h3>
      <p>All signals share one color by default. Each category has its own color.</p>
      <h4>Based on Impact:</h4>
      <div class="impact-row">
        <div class="impact-ball low"></div>
        <span>Low</span>
      </div>
      <div class="impact-row">
        <div class="impact-ball med"></div>
        <span>Medium</span>
      </div>
      <div class="impact-row">
        <div class="impact-ball high"></div>
        <span>High</span>
      </div>
      <h4>Signal Strength &amp; Maturity:</h4>
      <p>
        Weaker signals near the top<br>
        Medium signals in the middle<br>
        Strong signals near the bottom
      </p>
    </div>
  </div>

  <!-- TOOLTIP -->
  <div id="tooltip" style="
    position: fixed;
    background: rgba(0,0,0,0.7);
    padding: 0.5rem;
    border-radius: 4px;
    font-size: 0.9rem;
    pointer-events: none;
    display: none;">
  </div>

  <!-- QUICK VIEW CARD -->
  <div class="quick-view-card" id="quickViewCard">
    <button class="quickview-close" id="qvCloseBtn" aria-label="Close Card">×</button>
    <!-- Preview (Compact) -->
    <div class="preview-content">
      <img class="preview-img" id="previewImg" src="" alt="Preview Image" />
      <div class="preview-text">
        <div class="title" id="qvTitle">QuickView Title</div>
        <div>
          <div>
            <span class="preview-label">Strength:</span>
            <span id="previewStrength">N/A</span>
          </div>
          <div>
            <span class="preview-label">Impact:</span>
            <span id="previewImpact">N/A</span>
          </div>
        </div>
        <div class="desc" id="qvDesc" style="margin-bottom: 1rem;">
          Short description here
        </div>
        <button class="btn-extended" id="expandBtn">Show More</button>
      </div>
    </div>
    <!-- Detailed (Expanded) -->
    <div class="detailed-content">
      <button class="btn-back" id="backBtn">
        <span class="arrow-icon">&lt;</span>
        <span id="extendedTitle"></span>
      </button>
      <div class="card-top-row">
        <div class="metrics-container">
          <div class="metric-box">
            <div class="metric-title">Signal Strength</div>
            <div class="metric-value" id="cardStrength">N/A</div>
          </div>
          <div class="metric-box">
            <div class="metric-title">Signal Impact</div>
            <div class="metric-value" id="cardImpact">N/A</div>
          </div>
        </div>
        <div class="card-image-wrapper">
          <img src="" alt="Signal Image" id="cardImage" />
          <span class="image-credit" id="cardImageCredit"></span>
        </div>
      </div>
      <div class="section">
        <h3 class="section-header">Description</h3>
        <p id="cardDescription"></p>
        <span class="show-more-detailed" id="cardDescriptionToggle" onclick="toggleDetailed('cardDescription')">Show More</span>
      </div>
      <div class="section">
        <h3 class="section-header">Reference / Story</h3>
        <p id="cardReference"></p>
      </div>
      <!-- SIGNAL DEVELOPMENT SECTION (12 months) -->
      <div class="section" id="devSection">
        <h3 class="section-header">
          Signal Development (12 months)
          <span class="dev-holo-icon" id="devHoloIcon" title="View Methodology">!</span>
        </h3>
        <p id="cardDevelopment"></p>
        <!-- This image varies per signal via data-devimage -->
        <img id="devImage" class="dev-image" src="" alt="Developement Chart" />
        <!-- Floating legend: toggled via the "!" icon -->
        <div class="dev-holo-legend" id="devHoloLegend">
          <h4>Overview:</h4>
          <ul>
            <li>Measures signal strength over time using data from various sources.</li>
          </ul>
          <h4>Methodology:</h4>
          <ul>
            <li>Keywords Mapping: Relevant keywords linked to signals.</li>
            <li>Data Collection: Past year's news headlines from Google News.</li>
            <li>Data Modeling: Cleaned, filtered, and aggregated data.</li>
          </ul>
          <h4>Legend:</h4>
          <ul>
            <li><span class="dev-legend-color" style="color: #8B0000;">Dark Red (250)</span>: Strong signal</li>
            <li><span class="dev-legend-color" style="color: #FFD700;">Light Yellow (0)</span>: Weak signal</li>
            <li>Intermediate values (50, 100, 150, 200) show varying strengths.</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <h3 class="section-header">Dubai Context</h3>
        <p id="cardDubai"></p>
      </div>
      <div class="section">
        <h3 class="section-header">Systems &amp; Policy Implication</h3>
        <div
          id="cardPolicyWrapper"
          style="
            max-height: 100px;
            overflow: auto;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 0.5rem;
            border-radius: 4px;
          "
        >
          <div id="cardPolicyContent"></div>
        </div>
        <span class="show-more-detailed" id="cardPolicyToggle" onclick="toggleDetailed('cardPolicyContent')">Show More</span>
      </div>
      <div class="section">
        <h3 class="section-header">Sources</h3>
        <p id="cardSources"></p>
      </div>
      <div class="cta">
        <button class="btn-extended" id="collapseBtn">Collapse</button>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="footer-content">
      <div class="footer-logo">
        <img
          src="https://mosaiclive.com/wp-content/uploads/42-ml__0017_Vector-Smart-Object.png"
          alt="Mosaic Logo"
        />
      </div>
      <div class="footer-title">Signal.Radar</div>
    </div>
  </footer>

  <!-- Bootstrap Bundle JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-7QmEpZ0U1iNZ1kKPtdvervSVK9Bj2V4GrPuLHS3f07Hq5kBuTyrNEIzzyoZd8qBW"
    crossorigin="anonymous"
  ></script>
  <script>
    /******************************************************
     * GLOBAL FILTER VARIABLES
     ******************************************************/
    let currentWeek = "1-7 March";
    let activeCategory = "All";
    let activeSubCategory = null;

    /******************************************************
     * CATEGORY BUBBLE GRADIENT MAP
     ******************************************************/
    const categoryBubbleGradientMap = {
      "Behaviour": "var(--grad-digital-health)",
      "Healthcare":   "var(--grad-smart-cities)",
      "Infrastructure":  "var(--grad-public-health)",
      "Regulation": "var(--grad-economic-dev)",
      "Technology":          "var(--grad-other)"
    };

    /******************************************************
     * CATEGORY COLOR MAP (INCLUDES PLACEHOLDER)
     ******************************************************/
    const categoryColorMap = {
      "Behaviour": "var(--color-digital-health)",
      "Healthcare":   "var(--color-smart-cities)",
      "Infrastructure":  "var(--color-public-health)",
      "Regulation": "var(--color-economic-dev)",
      "Technology":          "var(--color-other)",
      "Placeholder":    "var(--color-placeholder)"
    };

    /******************************************************
     * SETUP CATEGORY BUBBLES => GRADIENTS
     ******************************************************/
    const categoryContainer = document.getElementById('categoryContainer');
    const catButtons = categoryContainer.querySelectorAll('.category-bubble');
    catButtons.forEach(btn => {
      const cat = btn.dataset.category;
      if (categoryBubbleGradientMap[cat]) {
        btn.style.background = categoryBubbleGradientMap[cat];
      }
    });

    /******************************************************
     * TIMELINE (CIRCULAR NODES)
     ******************************************************/
    const radarContainer = document.getElementById('radarContainer');
    const timelineNodes = document.querySelectorAll('.timeline-node');
    timelineNodes.forEach(node => {
      node.addEventListener('click', (e) => {
        e.stopPropagation();
        // Scroll the clicked node into center view
        node.scrollIntoView({ behavior: "smooth", inline: "center" });
        // Fade effect for week transition
        radarContainer.classList.add('week-transition');
        setTimeout(() => {
          currentWeek = node.dataset.week;
          timelineNodes.forEach(n => n.classList.remove('current-week'));
          node.classList.add('current-week');
          updateSignalsVisibility();
        }, 300);
        setTimeout(() => {
          radarContainer.classList.remove('week-transition');
        }, 600);
      });
    });

    /******************************************************
     * SIGNAL SETUP
     ******************************************************/
    const tooltip = document.getElementById('tooltip');
    const signals = document.querySelectorAll('.signal');
    signals.forEach(signal => {
      // 1) Assign color by category
      const cat = signal.dataset.category;
      if (categoryColorMap[cat]) {
        signal.style.backgroundColor = categoryColorMap[cat];
      } else {
        signal.style.backgroundColor = "var(--primary-color)";
      }
      // 2) Size by data-impact
      const impact = (signal.getAttribute('data-impact') || '').toLowerCase();
      let size;
      if (impact === 'high') {
        size = '2.9rem';
      } else if (impact === 'medium') {
        size = '2.2rem';
      } else {
        size = '1.5rem'; // default or "low"
      }
      signal.style.width = size;
      signal.style.height = size;

      // 3) Tooltip on hover
      signal.addEventListener('mouseover', (e) => {
        const title = signal.dataset.title || '';
        tooltip.textContent = title;
        tooltip.style.display = 'block';
        tooltip.style.left = e.pageX + 10 + 'px';
        tooltip.style.top = e.pageY - 10 + 'px';
      });
      signal.addEventListener('mouseout', () => {
        tooltip.style.display = 'none';
      });

      // 4) Quick View on click
      signal.addEventListener('click', (e) => {
        e.stopPropagation();
        populateQuickView(signal.dataset);
        quickViewCard.style.display = 'block';
        quickViewCard.classList.remove('expanded');
      });
    });

    /******************************************************
     * UPDATE SIGNALS VISIBILITY (by Week & Filters)
     ******************************************************/
    function updateSignalsVisibility() {
      signals.forEach(sig => {
        let visible = (sig.dataset.week === currentWeek);
        if (activeSubCategory) {
          visible = visible && (sig.dataset.subcategory === activeSubCategory);
        } else if (activeCategory && activeCategory !== "All") {
          visible = visible && (sig.dataset.category === activeCategory);
        }
        if (visible) {
          sig.style.display = 'block';
          setTimeout(() => {
            sig.style.opacity = '1';
            sig.style.pointerEvents = 'auto';
          }, 50);
        } else {
          sig.style.opacity = '0';
          sig.style.pointerEvents = 'none';
          setTimeout(() => {
            if (sig.style.opacity === '0') {
              sig.style.display = 'none';
            }
          }, 500);
        }
      });
    }

    /******************************************************
     * CATEGORY / SUBCATEGORY FILTERS
     ******************************************************/
    const subBubbles = document.querySelectorAll('.sub-bubble');
    function showAllSignals() {
      signals.forEach(sig => {
        if (sig.dataset.week === currentWeek) {
          sig.style.display = 'block';
          sig.style.opacity = '1';
          sig.style.pointerEvents = 'auto';
        } else {
          sig.style.display = 'none';
        }
      });
      catButtons.forEach(b => b.classList.remove('active'));
      activeCategory = "All";
      activeSubCategory = null;
    }
    catButtons.forEach(bubble => {
      bubble.addEventListener('click', (e) => {
        e.stopPropagation();
        activeSubCategory = null;
        activeCategory = bubble.dataset.category;
        catButtons.forEach(b => b.classList.remove('active'));
        bubble.classList.add('active');
        updateSignalsVisibility();
      });
    });
    subBubbles.forEach(sub => {
      sub.addEventListener('click', (e) => {
        e.stopPropagation();
        activeSubCategory = sub.dataset.subcategory;
        updateSignalsVisibility();
      });
    });

    /******************************************************
     * QUICK VIEW CARD
     ******************************************************/
    const quickViewCard = document.getElementById('quickViewCard');
    const qvCloseBtn = document.getElementById('qvCloseBtn');
    const expandBtn = document.getElementById('expandBtn');
    const collapseBtn = document.getElementById('collapseBtn');
    const backBtn = document.getElementById('backBtn');
    const extendedTitle = document.getElementById('extendedTitle');

    qvCloseBtn.addEventListener('click', () => {
      quickViewCard.style.display = 'none';
    });
    if (expandBtn) {
      expandBtn.addEventListener('click', () => {
        quickViewCard.classList.add('expanded');
      });
    }
    if (collapseBtn) {
      collapseBtn.addEventListener('click', () => {
        quickViewCard.classList.remove('expanded');
      });
    }
    if (backBtn) {
      backBtn.addEventListener('click', () => {
        quickViewCard.classList.remove('expanded');
      });
    }

    // Toggle detailed section text (for Description & Policy)
    function toggleDetailed(sectionId) {
      const sectionElem = document.getElementById(sectionId);
      const toggleLink = document.getElementById(sectionId === 'cardDescription' ? 'cardDescriptionToggle' : 'cardPolicyToggle');
      if (sectionElem.classList.contains('expanded-section')) {
        // Collapse: show truncated text
        const fullText = sectionElem.dataset.fullText || "";
        sectionElem.textContent = fullText.slice(0,120) + (fullText.length > 120 ? "..." : "");
        sectionElem.classList.remove('expanded-section');
        toggleLink.textContent = "Show More";
      } else {
        // Expand: show full text
        sectionElem.textContent = sectionElem.dataset.fullText || "";
        sectionElem.classList.add('expanded-section');
        toggleLink.textContent = "Show Less";
      }
    }

    // Populate Quick View Card
    function populateQuickView(data) {
      document.getElementById('qvTitle').textContent = data.title || 'QuickView Title';
      document.getElementById('previewStrength').textContent = data.strength || 'N/A';
      document.getElementById('previewImpact').textContent = data.impact || 'N/A';

      const shortDesc = (data.description || '').slice(0,120);
      document.getElementById('qvDesc').textContent =
        shortDesc + (data.description && data.description.length > 120 ? '...' : '');

      const previewImg = document.getElementById('previewImg');
      previewImg.src = data.image || '';
      extendedTitle.textContent = data.title || 'Title';

      document.getElementById('cardStrength').textContent = data.strength || 'N/A';
      document.getElementById('cardImpact').textContent = data.impact || 'N/A';
      document.getElementById('cardImage').src = data.image || '';
      document.getElementById('cardImageCredit').textContent = data.imagecredit || '';

      // For Description: store full text and set truncated text
      const cardDescElem = document.getElementById('cardDescription');
      cardDescElem.dataset.fullText = data.description || '';
      if ((data.description || '').length > 120) {
        cardDescElem.textContent = (data.description || '').slice(0,120) + "...";
        document.getElementById('cardDescriptionToggle').style.display = 'inline';
      } else {
        cardDescElem.textContent = data.description || '';
        document.getElementById('cardDescriptionToggle').style.display = 'none';
      }

      document.getElementById('cardReference').textContent = data.reference || '';

      // Populate the Signal Development section text
      document.getElementById('cardDevelopment').textContent = data.dev || '';
      // Set the development image if provided (data-devimage)
      document.getElementById('devImage').src = data.dev || '';
      document.getElementById('cardDubai').textContent = data.dubai || '';
      document.getElementById('cardSources').textContent = data.sources || '';

      // For Policy: store full text and set truncated text
      const cardPolicyElem = document.getElementById('cardPolicyContent');
      cardPolicyElem.dataset.fullText = data.policy || '';
      if ((data.policy || '').length > 120) {
        cardPolicyElem.textContent = (data.policy || '').slice(0,120) + "...";
        document.getElementById('cardPolicyToggle').style.display = 'inline';
      } else {
        cardPolicyElem.textContent = data.policy || '';
        document.getElementById('cardPolicyToggle').style.display = 'none';
      }
    }

    /******************************************************
     * LEGEND TOGGLE
     ******************************************************/
    const legendIcon = document.getElementById('legendIcon');
    const legendPanel = document.getElementById('legendPanel');
    legendIcon.addEventListener('mouseover', () => {
      legendPanel.classList.add('show');
    });
    legendIcon.addEventListener('mouseout', () => {
      legendPanel.classList.remove('show');
    });
    legendIcon.addEventListener('click', (e) => {
      e.stopPropagation();
      legendPanel.classList.toggle('show');
    });
    legendIcon.addEventListener('touchstart', (e) => {
      e.preventDefault();
      legendPanel.classList.toggle('show');
    });

    /******************************************************
     * DEV HOLO LEGEND TOGGLE
     ******************************************************/
    const devHoloIcon = document.getElementById('devHoloIcon');
    const devHoloLegend = document.getElementById('devHoloLegend');
    // Toggle the legend on click. It will remain visible until clicking outside or toggling again.
    devHoloIcon.addEventListener('click', (e) => {
      e.stopPropagation();
      if (devHoloLegend.style.display === 'block') {
        devHoloLegend.style.display = 'none';
      } else {
        devHoloLegend.style.display = 'block';
      }
    });

    /******************************************************
     * GLOBAL CLICK => close overlays
     ******************************************************/
    document.addEventListener('click', (e) => {
      // Close QuickView if click outside
      if (!quickViewCard.contains(e.target) && e.target !== quickViewCard) {
        quickViewCard.style.display = 'none';
      }
      // Close legend if click outside
      if (!legendIcon.contains(e.target) && !legendPanel.contains(e.target)) {
        legendPanel.classList.remove('show');
      }
      // Close the development legend if click outside
      if (!devHoloIcon.contains(e.target) && !devHoloLegend.contains(e.target)) {
        devHoloLegend.style.display = 'none';
      }
      // Close any sub-bubble-lists if click outside
      document.querySelectorAll('.sub-bubble-list').forEach(list => {
        if (!list.contains(e.target)) {
          list.style.opacity = '0';
          list.style.visibility = 'hidden';
        }
      });
    });

    // Initialize signals for currentWeek & filters
    updateSignalsVisibility();
  </script>
</body>
</html>
